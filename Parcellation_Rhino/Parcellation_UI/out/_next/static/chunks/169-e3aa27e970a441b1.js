"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[169],{90:(e,t,s)=>{s.d(t,{D:()=>r,K:()=>n});var a=s(3905),l=s(2115);let n=(0,l.createContext)({pm:(0,a.e)(),setPm:()=>{}}),r=()=>(0,l.useContext)(n)},1872:(e,t,s)=>{s.d(t,{T:()=>a});let a=e=>{window.chrome&&window.chrome.webview&&window.chrome.webview.postMessage(e)}},3905:(e,t,s)=>{s.d(t,{e:()=>a});let a=()=>({majorRoadWidth:5,minorRoadWidth:9,parcelPoints:[],roadNetwork:[]})},6169:(e,t,s)=>{s.d(t,{A:()=>_});var a=s(5155),l=s(2115);let n=e=>{let{loading:t,setLoading:s}=e,[n,r]=(0,l.useState)(""),[i,d]=(0,l.useState)(""),[c,o]=(0,l.useState)(0);return(0,l.useEffect)(()=>{if(!window.chrome||!window.chrome.webview)return;let e=e=>{let t=e.data;try{let e="string"==typeof t?JSON.parse(t):t;"ai_response"===e.eventType&&(s(!1),r(e.message),d(""),o(0))}catch(e){console.error("Invalid message received:",e)}};return window.chrome.webview.addEventListener("message",e),()=>{window.chrome.webview.removeEventListener("message",e)}},[]),(0,l.useEffect)(()=>{if(c<n.length){let e=setTimeout(()=>{d(e=>e+n[c]),o(e=>e+1)},10);return()=>clearTimeout(e)}},[c,n]),(0,a.jsx)("div",{className:"w-full h-full p-2 rounded-md bg-slate-50 border border-gray-500",children:(0,a.jsx)("div",{className:"text-sm overflow-y-auto select-text h-full",style:{whiteSpace:"pre-wrap"},children:t?(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)("span",{children:"Thinking..."})}):i})})};var r=s(3347),i=s(1872);let d=e=>{let{loading:t,handleLoadingState:s}=e,[n,d]=(0,l.useState)(""),c=(0,l.useRef)(null);return(0,l.useEffect)(()=>{!t&&(d(""),c.current&&(c.current.textContent=""))},[t]),(0,a.jsx)("div",{className:"mt-3 w-full rounded-md flex-[0.25]",children:(0,a.jsxs)("div",{id:"content",className:"flex flex-col items-end gap-2",children:[(0,a.jsx)("div",{ref:c,contentEditable:"true",className:"text-sm p-1 h-24 border border-gray-500 w-full bg-slate-50 rounded-md cursor-text overflow-y-auto",style:{whiteSpace:"pre-wrap"},onInput:e=>d(e.currentTarget.textContent||"")}),(0,a.jsx)("button",{className:"ml-2 p-2 bg-slate-400 text-white rounded-md hover:bg-slate-600 flex items-center justify-center",onClick:()=>{""!==n.trim()&&(console.log("Sending message:",n),s(!0),(0,i.T)({id:"ai_query",command:"AI_QUERY",payload:{message:n}}))},disabled:t,children:(0,a.jsx)(r.FPN,{size:20})})]})})},c=()=>{let[e,t]=(0,l.useState)(!1);return(0,a.jsxs)("div",{className:"w-full h-full flex flex-col flex-1 min-h-0 overflow-hidden",children:[(0,a.jsx)("div",{className:"flex-1 min-h-0",children:(0,a.jsx)(n,{loading:e,setLoading:t})}),(0,a.jsx)("div",{className:"flex-none",children:(0,a.jsx)(d,{loading:e,handleLoadingState:e=>{t(e)}})})]})};var o=s(4065),m=s(2502);m.t1.register(m.Bs,m.m_,m.s$,m.hE);let x=()=>{let[e,t]=(0,l.useState)(void 0);return(0,l.useEffect)(()=>{if(!window.chrome||!window.chrome.webview)return;let e=e=>{let s=e.data;if(console.log(s),"pie_chart_data"===s.eventType){let e=s.message;t(e),console.log(e)}};return window.chrome.webview.addEventListener("message",e),()=>{window.chrome&&window.chrome.webview&&window.chrome.webview.removeEventListener("message",e)}},[]),(0,a.jsx)(a.Fragment,{children:e&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(o.Fq,{data:e,options:{plugins:{title:{display:!0,text:e.title,font:{size:14},padding:{top:2,bottom:2}},legend:{display:!0,position:"bottom",labels:{boxWidth:20,padding:5,font:{size:14}}}}}})})})},h=()=>(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)("div",{className:"w-full h-full p-2 justify-center items-center flex",children:(0,a.jsx)(x,{})})}),u=()=>(0,a.jsxs)("div",{id:"analytics-panel",className:"h-[825px] w-[350px] rounded-lg flex flex-col overflow-hidden",children:[(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)(h,{})}),(0,a.jsxs)("div",{className:"pl-2 pr-2 flex-1 flex flex-col min-h-0",children:[(0,a.jsx)("label",{className:"text-sm mb-2",children:"Ai Assistant"}),(0,a.jsx)(c,{})]})]});var p=s(90);let v=()=>{let{pm:e,setPm:t}=(0,p.D)();return(0,a.jsxs)("div",{className:"grid grid-cols-2 sm:gap-1 gap-2 ",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,a.jsx)("button",{id:"selectParcel",className:"bg-slate-300 rounded-md min-h-[35px] shadow-md px-1 py-1 hover:bg-slate-200 transition-colors duration-100 active:bg-slate-50 text-sm",onClick:e=>{(0,i.T)({id:"parcel",command:"Select_Parcel"}),t({parcelPoints:[[2,2,2]]})},children:"Select Parcel"}),(0,a.jsx)("button",{id:"selectRoads",className:"bg-slate-300 transition-colors duration-100 px-1 text-sm hover:bg-slate-200 rounded-md min-h-[35px] shadow-md py-1 active:bg-slate-50",onClick:e=>{(0,i.T)({id:"road network",command:"Select_Road_Network"}),t({roadNetwork:[[[0,0,0],[1,2,0],[2,5,0]],[[4,7,0],[10,34,2]]]})},children:"Select Road Network"})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2",children:[(0,a.jsx)("button",{className:"bg-slate-300 rounded-md min-h-[35px] shadow-md px-1 py-1 hover:bg-slate-200 transition-colors duration-100 active:bg-slate-50 text-sm",onClick:e=>(0,i.T)({id:"attractor",command:"CITY_ATTRACTOR"}),children:"Select City Attractor"}),(0,a.jsx)("button",{id:"selectRoads",className:"bg-slate-300 transition-colors duration-100 px-1 text-sm hover:bg-slate-200 rounded-md min-h-[35px] shadow-md py-1 active:bg-slate-50",onClick:e=>(0,i.T)({id:"road network",command:"CITY_GREEN_POINTS"}),children:"Select Green Points"})]})]})};var w=s(5964),g=s.n(w);function j(){let{pm:e,setPm:t}=(0,p.D)(),[s,n]=(0,l.useState)(18),[r,d]=(0,l.useState)(9),[c,o]=(0,l.useState)(400),m=(0,l.useCallback)(g()(e=>{t({majorRoadWidth:e}),(0,i.T)({id:"road width slider",command:"Major_Road_Width",payload:{Width:e}})},100),[]),x=(0,l.useCallback)(g()(e=>{t({minorRoadWidth:e}),(0,i.T)({id:"road width slider",command:"Minor_Road_Width",payload:{Width:e}})},100),[]),h=(0,l.useCallback)(g()(e=>{(0,i.T)({id:"parcel slider",command:"Min_Parcel_Area",payload:{Area:e}})},100),[]);return(0,a.jsxs)("div",{className:"grid sm:grid-cols-1 select-none gap-2 relative",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm",children:["Major Road Width: ",s,"m"]}),(0,a.jsxs)("div",{className:"relative w-48 mt-4",children:[(0,a.jsx)("input",{type:"range",className:"sm:w-48 w-48 cursor-pointer appearance-none bg-gray-300 h-1 rounded-lg outline-none",min:6,max:30,step:.01,value:s,onChange:e=>{let t=parseFloat(e.target.value);n(t),m(t)}}),(0,a.jsxs)("div",{className:"absolute text-xs bg-gray-700 text-white px-1 py-0.5 rounded",style:{left:"calc(".concat((s-6)/24*100,"% - 5px)"),top:"-15px",whiteSpace:"nowrap",minWidth:"max-content"},children:[s," m"]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,a.jsx)("span",{children:"6 m"}),(0,a.jsx)("span",{children:"30 m"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm",children:["Minor Road Width: ",r,"m"]}),(0,a.jsxs)("div",{className:"relative w-48 mt-4",children:[(0,a.jsx)("input",{type:"range",className:"sm:w-48 w-48 cursor-pointer appearance-none bg-gray-300 h-1 rounded-lg outline-none",min:6,max:18,step:.01,value:r,onChange:e=>{let t=parseFloat(e.target.value);d(t),x(t)}}),(0,a.jsxs)("div",{className:"absolute text-xs bg-gray-700 text-white px-1 py-0.5 rounded",style:{left:"calc(".concat((r-6)/12*100,"% - 5px)"),top:"-15px",whiteSpace:"nowrap",minWidth:"max-content"},children:[r," m"]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,a.jsx)("span",{children:"6 m"}),(0,a.jsx)("span",{children:"18 m"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-sm",children:["Minimum Sub Parcel Area: ",c," m\xb2"]}),(0,a.jsxs)("div",{className:"relative w-48 mt-4",children:[(0,a.jsx)("input",{type:"range",className:"sm:w-48 w-48 cursor-pointer appearance-none bg-gray-300 h-1 rounded-lg outline-none",min:10,max:1e3,step:1,value:c,onChange:e=>{let t=parseInt(e.target.value,10);o(t),h(t)}}),(0,a.jsxs)("div",{className:"absolute text-xs bg-gray-700 text-white px-1 py-0.5 rounded",style:{left:"calc(".concat((c-10)/990*100,"% - 5px)"),top:"-15px",whiteSpace:"nowrap",minWidth:"max-content"},children:[c," m\xb2"]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,a.jsx)("span",{children:"10 m\xb2"}),(0,a.jsx)("span",{children:"1000 m\xb2"})]})]})]})]})}let f=()=>{let[e,t]=(0,l.useState)(60),[s,n]=(0,l.useState)(30),[r,d]=(0,l.useState)(20),[c,o]=(0,l.useState)(10),m=(0,l.useCallback)(g()((e,t)=>{(0,i.T)({id:"parcel",command:"SUB_PARCEL_SIZES",payload:{ParcelDepth:e,ParcelWidth:t}})},300),[]),x=(0,l.useCallback)(g()((e,t)=>{(0,i.T)({id:"building",command:"BUILDING_PARCEL_SIZES",payload:{ParcelDepth:e,ParcelWidth:t}})},300),[]);return(0,a.jsxs)("div",{className:"grid grid-cols-2 text-sm gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Sub Parcel Depth:"}),(0,a.jsxs)("div",{className:"flex items-center gap-x-1 text-sm mt-1",children:[(0,a.jsx)("input",{type:"number",min:0,max:1e4,value:e,onChange:e=>{let a=parseFloat(e.target.value)||60;t(a),m(a,s)},className:"border p-1 w-20"}),(0,a.jsx)("span",{children:"mt"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Sub Parcel Width:"}),(0,a.jsxs)("div",{className:"flex items-center gap-x-1 mt-1 text-sm",children:[(0,a.jsx)("input",{type:"number",min:0,max:1e4,value:s,onChange:t=>{let s=parseFloat(t.target.value)||100;n(s),m(e,s)},className:"border p-1 w-20"}),(0,a.jsx)("span",{children:"mt"})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Building Parcel Depth:"}),(0,a.jsxs)("div",{className:"flex items-center gap-x-1 text-sm mt-1",children:[(0,a.jsx)("input",{type:"number",min:0,max:1e4,value:r,onChange:e=>{let t=parseFloat(e.target.value)||0;d(t),x(t,c)},className:"border p-1 w-20"}),(0,a.jsx)("span",{children:"mt"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Building Parcel Width:"}),(0,a.jsxs)("div",{className:"flex items-center gap-x-1 text-sm mt-1",children:[(0,a.jsx)("input",{type:"number",min:0,max:1e4,value:c,onChange:e=>{let t=parseFloat(e.target.value)||0;o(t),x(r,t)},className:"border p-1 w-20"}),(0,a.jsx)("span",{children:"mt"})]})]})]})]})},b=e=>{let{id:t,command:s,label:n,range:r={min:0,max:100},initialValues:d={start:15,end:60}}=e,[c,o]=(0,l.useState)(d),[m,x]=(0,l.useState)(null),[h,u]=(0,l.useState)({start:!1,end:!1}),p=(0,l.useRef)(null),v=(0,l.useCallback)(g()(e=>{o(e),(0,i.T)({id:t,command:s,payload:{Min:e.start,Max:e.end}})},5),[]),w=e=>{let t=p.current.getBoundingClientRect();return Math.min(Math.max((e-t.left)/t.width*100,0),100)},j=e=>t=>{x(e),t.preventDefault()},f=(0,l.useCallback)(e=>{if(!m)return;let t=w(e.clientX),s={...c};"start"===m?s.start=Math.min(t,c.end-1):s.end=Math.max(t,c.start+1),v(s)},[m,c,v]),b=()=>x(null);return(0,l.useEffect)(()=>(m&&(document.addEventListener("mousemove",f),document.addEventListener("mouseup",b)),()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",b)}),[m,f]),(0,a.jsxs)("div",{className:"w-full max-w-2xl mx-auto px-4",children:[(0,a.jsxs)("div",{className:"relative h-16",ref:p,children:[(0,a.jsx)("div",{className:"absolute h-1 w-full bg-gray-200 rounded-full top-1/2 -translate-y-1/2",children:(0,a.jsx)("div",{className:"absolute h-full bg-gray-900 rounded-full",style:{left:"".concat(c.start,"%"),width:"".concat(c.end-c.start,"%")}})}),["start","end"].map(e=>(0,a.jsx)("button",{className:"absolute w-4 h-4 top-1/2 -ml-3 -translate-y-1/2 bg-gray-700 rounded-full shadow-lg focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 ".concat(m===e?"scale-110":""," hover:scale-110 transition-transform"),style:{left:"".concat(c[e],"%")},onMouseDown:j(e),onMouseEnter:()=>u(t=>({...t,[e]:!0})),onMouseLeave:()=>u(t=>({...t,[e]:!1})),role:"slider","aria-valuenow":c[e],"aria-valuemin":"start"===e?r.min:c.start,"aria-valuemax":"end"===e?r.max:c.end,tabIndex:0,children:h[e]&&(0,a.jsx)("div",{className:"absolute -top-6 left-1/2 -translate-x-1/2 bg-gray-900 text-white px-0.5 rounded text-sm",children:Math.round(c[e])})},e))]}),(0,a.jsxs)("div",{className:"text-center text-sm -mt-4",children:[n,": ",Math.round(c.start)," mts - ",Math.round(c.end)," mts"]})]})},N=()=>(0,a.jsxs)("div",{children:[(0,a.jsx)(b,{id:"parcel-depth",command:"PARCEL_DEPTH_RANGE",label:"Parcel Depth Range",initialValues:{start:15,end:60}}),(0,a.jsx)(b,{id:"parcel-width",command:"PARCEL_WIDTH_RANGE",label:"Parcel Width Range",initialValues:{start:10,end:50}})]}),y=()=>{let[e,t]=(0,l.useState)([]);return(0,l.useEffect)(()=>{if(!window.chrome||!window.chrome.webview)return;let e=e=>{let s=e.data;if("info_message"===s.eventType){let e=s.message;console.log(e),t(t=>[e])}};return window.chrome.webview.addEventListener("message",e),()=>{window.chrome&&window.chrome.webview&&window.chrome.webview.removeEventListener("message",e)}},[]),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"Info"}),(0,a.jsx)("div",{className:"overflow-hidden",children:(0,a.jsx)("div",{className:"h-20 flex flex-col bg-slate-300 pb-5 rounded-lg shadow-lg p-2",children:e.map((e,t)=>(0,a.jsx)("div",{className:"text-sm whitespace-pre-line gap",children:e},t))})})]})},S=()=>(0,a.jsxs)("div",{className:"flex gap-2 cursor-pointer text-sm select-none",children:[(0,a.jsx)("input",{type:"checkbox",id:"hide",className:"cursor-pointer",onChange:e=>{(0,i.T)({id:"hide",command:"HIDE",payload:{Hide:e.target.checked}})}}),(0,a.jsx)("label",{htmlFor:"hide",className:"cursor-pointer",children:"Hide"})]}),C=()=>(0,a.jsx)("div",{children:(0,a.jsx)(S,{})}),E=()=>(0,a.jsxs)("div",{id:"params",className:"bg-whiteshadow-lg rounded-lg w-[300px]",children:[(0,a.jsx)("label",{className:"text-lg text-slate-600",children:"Parcellation"}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)(v,{})}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(j,{})}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(f,{})}),(0,a.jsx)("div",{children:(0,a.jsx)(N,{})}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(C,{})}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(y,{})})]}),_=e=>{let{isWebView:t}=e;return(0,a.jsxs)("div",{id:"main",className:"flex flex-row gap-4 h-[850px]  p-2 select-none overflow-hidden ".concat(t?"w-[720px] min-w-[720px] max-w-[720px] pl-7 ":"w-[320px] min-w-[320px] max-w-[320px]"),children:[(0,a.jsx)(E,{}),t&&(0,a.jsx)(u,{})]})}}}]);