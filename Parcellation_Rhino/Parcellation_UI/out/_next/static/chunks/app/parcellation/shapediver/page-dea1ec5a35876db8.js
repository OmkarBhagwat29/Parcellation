(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[227],{2862:(e,t,a)=>{"use strict";a.d(t,{default:()=>D});var l=a(5155),s=a(2115),n=a(6169),d=a(6438);let r=()=>({sdk:void 0,defaultState:void 0,newState:void 0,modelData:[],modelIds:[]}),o=(0,s.createContext)({sd:r(),setSd:()=>{}}),c=()=>(0,s.useContext)(o);var i=a(90),u=a(9530);let f=null,h=()=>(f||(f=(0,u.create)("https://sdr8euc1.eu-central-1.shapediver.com")),f),m=()=>{let{pm:e}=(0,i.D)(),{sd:t,setSd:a}=c(),l=(0,s.useRef)(!1);return(0,s.useEffect)(()=>{!l.current&&(l.current=!0,(async()=>{try{let e=h();console.log("Initializing SDK...");let t=await e.session.init("d342133af0dda25ac4282f8c58c23e86cc1b123c38dd9ab56acd0f77d544f0fec9e71a4b6423d835cf481e4ba798c5c3b5e8b740f6f9363efd49592ebb9483382903ded078698e8cd42dca872317defe7f2fd710dac51ea4e2504c2ab811f345e197e279a1afe4d9563167754b8561148485f762fdc757ab-18f4d14da3017a2f429aa8a06fccc664");a({sdk:e,defaultState:t}),console.log("SDK Initialized:",e),console.log("default state:",t)}catch(e){console.error("Error initializing SDK:",e)}})())},[]),null};var v=a(630);let g=()=>{let{pm:e}=(0,i.D)(),{sd:t,setSd:a}=c(),{scene:n}=(0,v.A)();return(0,s.useEffect)(()=>{e&&t.defaultState&&(async()=>{var l;let s={Radius:Math.round(e.majorRoadWidth)},d=await (null===(l=t.sdk)||void 0===l?void 0:l.utils.submitAndWaitForCustomization(t.sdk,t.defaultState.sessionId,s));d&&t.modelIds.length>0&&(console.log("removing old object"),t.modelIds.forEach(e=>n.remove(e))),console.log(s),console.log("New Evaluated State:",d),a({newState:d,modelIds:[]})})()},[e,t.defaultState]),(0,l.jsx)(l.Fragment,{})},x=()=>{let{sd:e,setSd:t}=c();return(0,s.useEffect)(()=>{e.newState&&(()=>{var a;let l=[];for(let t in null===(a=e.newState)||void 0===a?void 0:a.outputs){let a=e.newState.outputs[t],s=e.defaultState.outputs[t];if(a.version!==s.version){let e=a.content;if(!e)return;let t=[];for(let a=0;a<e.length;a++){let l=e[a];console.log(l),l.href&&t.push(l.href)}t.length>0&&l.push({name:a.name,paths:t})}}l.length>0&&(t({modelData:l}),console.log(l))})()},[e.newState]),(0,l.jsx)(l.Fragment,{})};var j=a(3264),b=a(9311);let w=()=>{let{sd:e,setSd:t}=c(),{scene:a}=(0,v.A)();return(0,s.useEffect)(()=>{0!=e.modelData.length&&(async()=>{let l=new b.B,s=await l.loadAsync(e.modelData[0].paths[0]);console.log(s),"glTFDisplay"===e.modelData[0].name&&(s.scene.traverse(e=>{e instanceof j.eaF&&(e.material=new j._4j({color:"blue",wireframe:!0}))}),a.add(s.scene),t({modelIds:[s.scene]})),console.log(a.children)})()},[e.modelData]),(0,l.jsx)(l.Fragment,{})},S=()=>{let e=r(),[t,a]=(0,s.useState)(e);return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(o,{value:{sd:t,setSd:e=>{a(t=>({...t,...e}))}},children:[(0,l.jsx)(m,{}),(0,l.jsx)(g,{}),(0,l.jsx)(x,{}),(0,l.jsx)(w,{})]})})};var p=a(3905);let D=()=>{let e=(0,p.e)(),[t,a]=(0,s.useState)(e);return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"flex w-screen h-screen overflow-hidden",children:(0,l.jsxs)(i.K,{value:{pm:t,setPm:e=>{a(t=>({...t,...e}))}},children:[(0,l.jsx)(n.A,{isWebView:!1}),(0,l.jsxs)(d.A,{children:[(0,l.jsx)(S,{}),(0,l.jsx)("ambientLight",{})]})]})})})}},5674:(e,t,a)=>{Promise.resolve().then(a.bind(a,2862))},6438:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var l=a(5155);a(2115);var s=a(4688),n=a(5011),d=a(7558);let r=e=>{let{children:t}=e;return(0,l.jsx)("div",{style:{width:"100vw",height:"100vh"},className:"bg-slate-100",children:(0,l.jsxs)(d.Hl,{style:{width:"100%",height:"100%"},camera:{fov:45},children:[(0,l.jsx)("axesHelper",{}),(0,l.jsx)(s.N,{}),(0,l.jsx)(n.x,{scale:5}),t]})})},o=e=>{let{children:t}=e;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(r,{children:t})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[204,647,831,367,413,655,13,290,169,441,684,358],()=>t(5674)),_N_E=e.O()}]);